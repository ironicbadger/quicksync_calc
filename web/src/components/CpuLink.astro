---
/**
 * CpuLink component - renders a clickable link to the CPU's generation detail page
 *
 * Usage:
 *   <CpuLink cpuRaw="Intel(R) Core(TM) i5-8500 CPU @ 3.00GHz" generation={8} />
 *   <CpuLink cpuRaw="Intel Arc A770" architecture="Arc Alchemist" />
 */

interface Props {
  cpuRaw: string;
  generation?: number | null;
  architecture?: string | null;
  showFullName?: boolean;
}

const { cpuRaw, generation, architecture, showFullName = false } = Astro.props;

// Strip Intel branding for cleaner display
function stripIntelBranding(cpu: string): string {
  return cpu
    .replace(/Intel\(R\)\s*/gi, '')
    .replace(/Core\(TM\)\s*/gi, '')
    .replace(/CPU\s*@\s*[\d.]+GHz/gi, '')
    .replace(/\s+/g, ' ')
    .trim();
}

// Determine the link URL based on architecture/generation
function getCpuLink(): string | null {
  // Arc GPUs go to their own page
  if (architecture?.includes('Arc')) {
    if (architecture === 'Arc Alchemist') {
      return '/gpu/arc/alchemist';
    }
    if (architecture === 'Arc Battlemage') {
      return '/gpu/arc/battlemage';
    }
    return '/gpu/arc/all';
  }

  // Ultra Series (Meteor Lake, Arrow Lake, Lunar Lake)
  if (architecture === 'Meteor Lake') {
    return '/cpu/gen/ultra-1';
  }
  if (architecture === 'Arrow Lake' || architecture === 'Lunar Lake') {
    return '/cpu/gen/ultra-2';
  }

  // Standard generations (2-14)
  if (generation && generation >= 2 && generation <= 14) {
    return `/cpu/gen/${generation}`;
  }

  return null;
}

const displayName = showFullName ? cpuRaw : stripIntelBranding(cpuRaw);
const href = getCpuLink();
---

{href ? (
  <a href={href} class="cpu-link" title={cpuRaw}>
    {displayName}
  </a>
) : (
  <span class="cpu-name" title={cpuRaw}>
    {displayName}
  </span>
)}

<style>
  .cpu-link {
    color: var(--color-accent);
    text-decoration: none;
    transition: color 0.15s ease;
  }

  .cpu-link:hover {
    color: var(--color-accent-hover, #60a5fa);
    text-decoration: underline;
  }

  .cpu-name {
    color: var(--color-text);
  }
</style>
