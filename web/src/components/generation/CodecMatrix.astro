---
/**
 * CodecMatrix - Visual codec support table with checkmarks/crosses
 */

interface Props {
  codecSupport: {
    h264_encode: boolean;
    hevc_8bit_encode: boolean;
    hevc_10bit_encode: boolean;
    vp9_encode: boolean;
    av1_encode: boolean;
  };
  compact?: boolean;
}

const { codecSupport, compact = false } = Astro.props;

const codecs = [
  { key: 'h264_encode', name: 'H.264', description: 'Most compatible, widely supported' },
  { key: 'hevc_8bit_encode', name: 'HEVC 8-bit', description: 'Better compression than H.264' },
  { key: 'hevc_10bit_encode', name: 'HEVC 10-bit', description: 'HDR support, better gradients' },
  { key: 'vp9_encode', name: 'VP9', description: 'YouTube/web streaming codec' },
  { key: 'av1_encode', name: 'AV1', description: 'Next-gen, best compression' },
] as const;
---

<div class:list={['codec-matrix', { compact }]}>
  <table>
    <thead>
      <tr>
        <th>Codec</th>
        <th>Encode</th>
        {!compact && <th>Notes</th>}
      </tr>
    </thead>
    <tbody>
      {codecs.map(codec => {
        const supported = codecSupport[codec.key as keyof typeof codecSupport];
        return (
          <tr class:list={{ supported, unsupported: !supported }}>
            <td class="codec-name">{codec.name}</td>
            <td class="codec-status">
              {supported ? (
                <span class="status-yes" title="Hardware encode supported">&#10003;</span>
              ) : (
                <span class="status-no" title="Not supported">&#10005;</span>
              )}
            </td>
            {!compact && (
              <td class="codec-description">{codec.description}</td>
            )}
          </tr>
        );
      })}
    </tbody>
  </table>
</div>

<style>
  .codec-matrix {
    width: 100%;
  }

  .codec-matrix table {
    width: 100%;
    border-collapse: collapse;
  }

  .codec-matrix th {
    text-align: left;
    padding: 0.5rem 0.75rem;
    font-weight: 500;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
    border-bottom: 1px solid var(--color-border);
  }

  .codec-matrix td {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid var(--color-border);
    font-size: 0.875rem;
  }

  .codec-name {
    font-weight: 500;
  }

  .codec-status {
    text-align: center;
    width: 4rem;
  }

  .status-yes {
    color: #22c55e;
    font-weight: 700;
    font-size: 1.25rem;
  }

  .status-no {
    color: #6b7280;
    font-size: 1rem;
  }

  .codec-description {
    color: var(--color-text-muted);
    font-size: 0.8125rem;
  }

  tr.supported .codec-name {
    color: var(--color-text);
  }

  tr.unsupported .codec-name {
    color: var(--color-text-muted);
  }

  /* Compact mode */
  .codec-matrix.compact th,
  .codec-matrix.compact td {
    padding: 0.375rem 0.5rem;
  }

  .codec-matrix.compact .codec-name {
    font-size: 0.8125rem;
  }
</style>
